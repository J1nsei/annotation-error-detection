# Annotation error searching tool

![](https://github.com/J1nsei/Auto-Boxer/blob/main/utils/idea.gif)

## Описание
Инструмент, предназначенный для упрощения и автоматизации процесса анализа аннотаций данных в контексте обнаружения объектов. Он предоставляет мощные возможности для обнаружения и отображения ошибок в аннотациях к данным, таких как неправильно размещенные метки классов, неправильно определенные ограничивающие рамки или даже отсутствующие аннотации. Кроме того, есть полезная визуализация ошибок с помощью FiftyOne, а также анализ их вклада в метрику mAP.
### Типы ошибок:
- **Classification error (CLS)**: неправильная метка класса (т.е. локализована правильно, но неправильно классифицирована).
- **Localization error (LOC)**: неправильно локализован, правильно классифицирован.
- **Classification and Localization error (CLS & LOC)**: неправильная классификация и локализация одновременно.
- **Duplicate detection error (DUP)**: цель обнаружена правильно, но существует более точное обнаружение (показатель достоверности выше).
- **Background error (BKG)**: фон обнаружен как передний план.
- **Missed target error (MISS)**: необнаруженные цели, которые не были помечены как ошибки классификации или локализации.


## Установка
1. Установите Python >= 3.10.
2. Установите [PyTorch](https://pytorch.org/get-started/locally/).
3. Установите зависимости:
```python -m pip install -r requirements.txt```

## Использование
- Запуск в режиме поиска ошибок (для обучения *train=True*):
    - Linux:
        ``` python3 main.py --data='./dataset' --model='./models/default/demo.pt' --train=False --impact=True ```

    - Windows:
        ``` python main.py --data=".\\dataset" --model=".\\models\\default\\demo.pt" --train=False --impact=True ```
- Описание параметров:
    - **data** = './dataset' (путь к директории с датасетом).
    - **model** = './models/my_model.pt' (путь к модели)
    - **impact** = True (включение анализа влияния ошибок на метрику mAP)
    - **labels** = 'labels_N.json' (выбор подмножества разметки данных)
    - **preds** = 'preds_N.pkl' (выбор подмножества предсказаний)
    - **save_preds** = True (сохранение предсказаний)
## Формат и хранение данных
- Данные должны быть размечены в **COCO** формате.
- Формат хранения:
    ```bash
    ├── dataset
    │   ├── labels.json  <--------- файл аннотации
    │   └── images       <--------- папка с изображениями
    │       ├── img1.jpg
    │       ├── ...
    │       └── imgN.jpg
    ├── models
    ├── utils
    ├── main.py
    └── README.md
    ```
## Использование собственной модели
Чтобы использовать свою собственную обученную модель YOLOv8, поместите файл с весами в папку *models* и укажите путь к ним при запуске (``--model='./models/my_model.pt"` ).

